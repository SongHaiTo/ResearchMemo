# 流形学习

数据形成的流形结构并非只有曲线一种情况，它可能会有如图7所示的瑞士卷的复杂结构。他可能还不止一个，比如两个卷在一起的双螺旋线。
那么，要想利用经典又好使的欧氏距离来解决问题，可行的方案之一就是把它们摊平或拉平，这样，我们待分析的数据所处的空间就是欧氏空
间了。于是，有大量的流形学习的工作便在此基础上展开了。

最经典的两篇是与《流形的感知方式》几乎同时于2000年发表在Science上。因为计算机科学的工作很少有发Science的，能发在上面，则有
可能引导大方向的研究。所以，这三项工作被视为引领了2000年后流形学习发展的奠基之作。

## Tenenbaum的ISOMAP

Tenenbaum的工作是从测地线距离的计算来考虑的，但测地线是在连续意义定义的，要根据离散的数据点来算的话，Tenenbaum等找了个平衡，
提出了基于图距离的局部等度规算法。他们假定邻域内的点与点之间相连的距离都等于1，邻域以外的距离都强设为0。因为流形可以由若干个
小的邻域来粘合构成，而相邻的邻域总会有部分的重叠，那么，如果把所有距离为1的都连条边出来，则原来的数据点就构成了一张连通图。而
远点的距离或者所谓的测地线距离，就可以通过连通的边的最短距离来近似了，如图8中图所示。于是，就可以为所有的点建立一个相似性或距
离矩阵。有了这个矩阵，再通过统计方法就能找到其主要的几个方向了，即摊平的低维子空间，如图8右图所示，蓝色的测地线距离就为红色的
图距离近似了。

## Roweis和Laul的LLE

而Roweis和Laul当时则从另一角度来尝试恢复这个平坦的空间。他假定邻域内的数据点会相互保持一种几何关系，关系的紧密程度由权重来决定，
权重的总和等于1。同时，他假定这个权重诱导的关系在平坦空间会与观测的空间保持一致，即局部结构不变。当然，还得防止数据在还原到低维
的平坦空间时不致于坍缩至一点去。基于这些假设，很自然地就把优化方程写了出来，并获得了不用迭代求解的闭式解，即局部线性嵌入算法，
如图9所示。

## 流形学习的物理意义

算法比较直白，但两篇文章都发现了类似于图3和图4的现象，即约简到二维平面后，数据的分布具有物理意义的。比如，手旋转杯的动作会沿水平
方向连续变化 ，人脸图像的姿态和表情会在两个垂直的轴上分别连续变化 。而这种情况，以前的算法似乎是找不到的。除此以外，这两篇工作的
成果又很好地与“感知的流形方式”吻合了。

## 流形是欧氏空间的一般性推广

还有一点，邻域的大小决定了流形的表现。按几何学大牛Spivak的说法，邻域如果和整个欧氏空间一样大的，那欧氏空间本身就是流形[5]。
所以，流形学习的研究并非是一个很特别、很小众的方向，它是对常规欧氏空间下研究问题的一般性推广。

于是，从2000年开始，国内外对流形学习的研究进入了高潮，希望能找到更有效的发现低维平坦空间的方法。比如希望保持在投影到平坦空间后三
点之间角度不变的保角算法；比如希望保持二阶光滑性不变的海森方法；比如希望保持长宽比不变的最大方差展开方法；比如希望保持局部权重比
不变的拉普拉斯算法等。不过何种方法，都在尝试还原或保持流形的某一种性质。也有考虑数据本身有噪导致结构易被误导的，比如我们经常在星
际旅行中提到的虫洞现象，如图10。它可以将原本隔得很远的两个位置瞬间拉近。在数据分析中，称虫洞为捷近或短路边(shortcut)，是需要避免
的，不然会导致还原的空间是不正常甚至错误的。


---
原文作者：张军平 ，复旦大学计算机科学技术学院教授、博士生导师，中国自动化学会混合智能专委会副主任。主要研究方向包括人工智能、机器学习、图像处理、生物认证及智能交通。至今发表论文近100篇，其中IEEE Transactions系列18篇，包括IEEE TPAMI, TNNLS, ToC, TITS, TAC等。学术谷歌引用2700余次，ESI高被引一篇，H指数为27。

参考文献：
1. H. Sebastian Seung, Daniel D. Lee. The Manifold Way of Perception. Science 290 (5500): 2268-2269.
2. 李子青，张军平. 人脸识别的子空间统计学习. 机器学习及应用，清华大学出版社，2006，pp.270-301.
3. B. Tenenbaum, V. de Silva, J. C. Langford. A Global Geometric Framework for Nonlinear Dimensionality Reduction. Science 290 (5500): 2319-2323
4. Roweis, L. Saul. Nonlinear dimensionality reduction by locally linear embedding. Science 290 (5500): 2323--2326.
5. Michael Spivak. A Comprehensive Introduction to Differential Geometry, Vol. 1, 3rd Edition. Publish or Perish, 1999.
6. LeCun Yann. Predictive Learning. Slide at NIPS 2016.
